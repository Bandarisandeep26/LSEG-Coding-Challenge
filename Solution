Scenario-1: When you are inside the EC2 instance.


#!/bin/bash

#Get-token-for-metadata-access
TOKEN=$(curl -s -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 120")

#This-will-list-all-metadata-keys-not-values
echo "list of metadata on this instance:"
curl -s -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/

#This-will-ask-user-for-key
read -p "enter the key to retrieve: " KEY

#Display-value-for-selected-key
VALUE=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/$KEY)

#Convert-to-json
echo "{\"$KEY\": \"$VALUE\"}"



Scenario-2: When you are not inside the EC2 instance.

- name: ec2 instance metadata
  hosts: ec2-instance
  tasks:
    - name: show ec2 metadata
      ec2_metadata_facts:
    - debug:
        var: ansible_facts.ec2_metadata

# we can also utilise Terraform datasources if ec2 is not managed by terraform; if ec2 is managed by terraform we can use terraform output block and terraform output command to get the metadata 







